---
layout: archive
---

{{ content }}

{% assign entries = site.posts | concat: site.book | concat: site.journal-articles | concat: site.book-sections | concat: site.research-reports | concat: site.news-articles | concat: site.media-appereances | concat: site.research-presentations | concat: site.teaching-presentations | concat: site.preprint-articles %}
{% assign entries_by_tag = entries | where_exp: "item", "item.tags contains page.tag" | sort: "date" | reverse %}

{% comment %} Get all unique categories from tagged entries {% endcomment %}
{% assign all_categories = "" | split: "" %}
{% for entry in entries_by_tag %}
  {% if entry.categories %}
    {% for cat in entry.categories %}
      {% unless all_categories contains cat %}
        {% assign all_categories = all_categories | push: cat %}
      {% endunless %}
    {% endfor %}
  {% endif %}
{% endfor %}

{% comment %} Display entries grouped by category {% endcomment %}
{% for category in all_categories %}
  {% assign category_entries = entries_by_tag | where_exp: "item", "item.categories contains category" %}
  
  {% if category_entries.size > 0 %}
    <h2 class="archive__subtitle">{{ category | capitalize }}</h2>
    <div class="entries-{{ entries_layout }}">
      {% for post in category_entries %}
        {% include archive-single.html type=entries_layout %}
      {% endfor %}
    </div>
  {% endif %}
{% endfor %}

{% comment %} Display entries without categories {% endcomment %}
{% assign uncategorized = entries_by_tag | where_exp: "item", "item.categories == nil or item.categories.size == 0" %}
{% if uncategorized.size > 0 %}
  <h2 class="archive__subtitle">Uncategorized</h2>
  <div class="entries-{{ entries_layout }}">
    {% for post in uncategorized %}
      {% include archive-single.html type=entries_layout %}
    {% endfor %}
  </div>
{% endif %}